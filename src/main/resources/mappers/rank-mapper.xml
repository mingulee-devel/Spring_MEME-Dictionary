<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="RankMapper">

	<resultMap type="org.kh.meme.rank.domain.QuizRank" id="quizRankMap">
		<id property="memberId" column="MEMBER_ID"/>
		<result property="quizBestscore" column="QUIZ_BESTSCORE"/>
		<result property="quizBestdate" column="QUIZ_BESTDATE"/>
		<result property="quizRank" column="QUIZ_RANK"/>
	</resultMap>

	<select id="selectQuizRank" resultMap="quizRankMap">
		SELECT * 
		FROM (
		SELECT MEMBER_ID, QUIZ_BESTSCORE, QUIZ_BESTDATE, 
		DENSE_RANK() OVER(ORDER BY QUIZ_BESTSCORE DESC) QUIZ_RANK
		FROM QUIZ_BEST
		ORDER BY QUIZ_RANK ASC
		)
		<![CDATA[WHERE ROWNUM <= 5]]>
	</select>

</mapper>